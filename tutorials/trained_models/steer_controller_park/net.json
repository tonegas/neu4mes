{"Constants": {"L": {"dim": 1, "values": 2.6},
               "delta_sw_map": {"dim": 1,
                                "sw": 100,
                                "values": [[-12.566370614359172],
                                           [-12.317667228843606],
                                           [-12.068966471309635],
                                           [-11.820265825356046],
                                           [-11.571565179514732],
                                           [-11.322864540459207],
                                           [-11.074163920743521],
                                           [-10.825463293624303],
                                           [-10.576762669863411],
                                           [-10.328062048210148],
                                           [-10.079361428370472],
                                           [-9.830660810473539],
                                           [-9.579910826819845],
                                           [-9.328554024315052],
                                           [-9.077197223572972],
                                           [-8.825840424617516],
                                           [-8.574483627419239],
                                           [-8.323126831955436],
                                           [-8.071770038207779],
                                           [-7.820413246158329],
                                           [-7.569056455788025],
                                           [-7.317699667076132],
                                           [-7.0663428799641315],
                                           [-6.812581673425538],
                                           [-6.557591364058054],
                                           [-6.302601055935444],
                                           [-6.047610749198625],
                                           [-5.7926204438148545],
                                           [-5.5376301397464],
                                           [-5.2826398369602385],
                                           [-5.027649535423559],
                                           [-4.7726592351026405],
                                           [-4.5176689359623845],
                                           [-4.262678637957099],
                                           [-4.005539132841002],
                                           [-3.747522764744508],
                                           [-3.489506397340142],
                                           [-3.2314900307429033],
                                           [-2.97347366491614],
                                           [-2.715457299814998],
                                           [-2.457440935396768],
                                           [-2.1994245716192133],
                                           [-1.9414082084394868],
                                           [-1.6833918458141113],
                                           [-1.425375483698372],
                                           [-1.1663240055764628],
                                           [-0.9071408812324386],
                                           [-0.6479577570168534],
                                           [-0.3887746329303352],
                                           [-0.12959150892926838],
                                           [0.12959161503046907],
                                           [0.38877473899465703],
                                           [0.6479578630083775],
                                           [0.9071409871161015],
                                           [1.1663241113616019],
                                           [1.4253755890681055],
                                           [1.6833919512521918],
                                           [1.9414083137623055],
                                           [2.1994246768128605],
                                           [2.4574410404385536],
                                           [2.7154574046733146],
                                           [2.9734737695550693],
                                           [3.231490135122668],
                                           [3.4895065014152418],
                                           [3.7475228684711706],
                                           [4.00553923632379],
                                           [4.262678740295073],
                                           [4.517669038229952],
                                           [4.772659336962569],
                                           [5.0276496368638925],
                                           [5.282639937964834],
                                           [5.537630240281641],
                                           [5.792620543838296],
                                           [6.047610848660226],
                                           [6.30260115477234],
                                           [6.5575914621979345],
                                           [6.812581770958114],
                                           [7.066342975745462],
                                           [7.317699762301716],
                                           [7.56905655014124],
                                           [7.820413339628373],
                                           [8.071770130768],
                                           [8.323126923554328],
                                           [8.57448371799228],
                                           [8.825840514089446],
                                           [9.077197311853576],
                                           [9.328554111291371],
                                           [9.579910912407929],
                                           [9.830660893800758],
                                           [10.079361510197389],
                                           [10.328062128342978],
                                           [10.576762748396824],
                                           [10.82546337032777],
                                           [11.074163994111228],
                                           [11.322864619735677],
                                           [11.571565247194115],
                                           [11.820265876481173],
                                           [12.068966507591679],
                                           [12.317667140520156],
                                           [12.566367775260755]]},
               "delta_w_avg_map": {"dim": 1,
                                   "sw": 100,
                                   "values": [[-0.6417302839400707],
                                              [-0.6287660357796734],
                                              [-0.6158017876192587],
                                              [-0.6028375394588616],
                                              [-0.589873291298447],
                                              [-0.5769090431380498],
                                              [-0.5639447949776352],
                                              [-0.5509805468172381],
                                              [-0.5380162986568233],
                                              [-0.5250520504964262],
                                              [-0.512087802336029],
                                              [-0.4991235541756144],
                                              [-0.4861593060152172],
                                              [-0.4731950578548026],
                                              [-0.4602308096944054],
                                              [-0.44726656153399075],
                                              [-0.43430231337359354],
                                              [-0.42133806521317896],
                                              [-0.40837381705278175],
                                              [-0.3954095688923671],
                                              [-0.3824453207319699],
                                              [-0.3694810725715553],
                                              [-0.3565168244111581],
                                              [-0.3435525762507435],
                                              [-0.33058832809034633],
                                              [-0.3176240799299317],
                                              [-0.3046598317695345],
                                              [-0.29169558360911985],
                                              [-0.2787313354487227],
                                              [-0.265767087288308],
                                              [-0.25280283912791085],
                                              [-0.2398385909674962],
                                              [-0.22687434280709903],
                                              [-0.2139100946466844],
                                              [-0.20094584648628722],
                                              [-0.18798159832587258],
                                              [-0.1750173501654754],
                                              [-0.16205310200507822],
                                              [-0.14908885384466358],
                                              [-0.1361246056842664],
                                              [-0.12316035752385175],
                                              [-0.11019610936345457],
                                              [-0.09723186120303993],
                                              [-0.08426761304264276],
                                              [-0.07130336488222812],
                                              [-0.05833911672183095],
                                              [-0.045374868561416315],
                                              [-0.032410620401019136],
                                              [-0.019446372240604498],
                                              [-0.006482124080207318],
                                              [0.006482124080207318],
                                              [0.019446372240604498],
                                              [0.032410620401019136],
                                              [0.045374868561416315],
                                              [0.05833911672183095],
                                              [0.07130336488222812],
                                              [0.08426761304264276],
                                              [0.09723186120303993],
                                              [0.11019610936345457],
                                              [0.12316035752385175],
                                              [0.1361246056842664],
                                              [0.14908885384466358],
                                              [0.16205310200507822],
                                              [0.1750173501654754],
                                              [0.18798159832587258],
                                              [0.20094584648628722],
                                              [0.2139100946466844],
                                              [0.22687434280709903],
                                              [0.2398385909674962],
                                              [0.25280283912791085],
                                              [0.265767087288308],
                                              [0.2787313354487227],
                                              [0.29169558360911985],
                                              [0.3046598317695345],
                                              [0.3176240799299317],
                                              [0.33058832809034633],
                                              [0.3435525762507435],
                                              [0.3565168244111581],
                                              [0.3694810725715553],
                                              [0.3824453207319699],
                                              [0.3954095688923671],
                                              [0.40837381705278175],
                                              [0.42133806521317896],
                                              [0.43430231337359354],
                                              [0.44726656153399075],
                                              [0.4602308096944054],
                                              [0.4731950578548026],
                                              [0.4861593060152172],
                                              [0.4991235541756144],
                                              [0.512087802336029],
                                              [0.5250520504964262],
                                              [0.5380162986568233],
                                              [0.5509805468172381],
                                              [0.5639447949776352],
                                              [0.5769090431380498],
                                              [0.589873291298447],
                                              [0.6028375394588616],
                                              [0.6158017876192587],
                                              [0.6287660357796734],
                                              [0.6417302839400707]]}},
 "Functions": {"FParamFun11": {"code": "def linear_interp(x,x_data,y_data):\n    # Inputs: \n    # x: query point, a tensor of shape torch.Size([N, 1, 1])\n    # x_data: map of x values, sorted in ascending order, a tensor of shape torch.Size([Q, 1])\n    # y_data: map of y values, a tensor of shape torch.Size([Q, 1])\n    # Output:\n    # y: interpolated value at x, a tensor of shape torch.Size([N, 1, 1])\n\n    # Saturate x to the range of x_data\n    x = torch.min(torch.max(x,x_data[0]),x_data[-1])\n\n    # Find the index of the closest value in x_data\n    idx = torch.argmin(torch.abs(x_data[:-1] - x),dim=1)\n\n    # Linear interpolation\n    y = y_data[idx] + (y_data[idx+1] - y_data[idx])/(x_data[idx+1] - x_data[idx])*(x - x_data[idx])\n    return y\n",
                               "in_dim": [{"dim": 1, "sw": 1}],
                               "map_over_dim": false,
                               "n_input": 1,
                               "name": "linear_interp",
                               "out_dim": {"dim": 1, "sw": 1},
                               "params_and_consts": ["delta_w_avg_map",
                                                     "delta_sw_map"]},
               "FParamFun7": {"code": "def curvat_diagram(curv,L,h_1,h_2,h_3):\n  return torch.atan(h_1*curv + h_2*torch.pow(curv,3) + h_3*torch.pow(curv,5) + curv*L)\n",
                              "in_dim": [{"dim": 1, "sw": 15}],
                              "map_over_dim": false,
                              "n_input": 1,
                              "name": "curvat_diagram",
                              "out_dim": {"dim": 1, "sw": 15},
                              "params_and_consts": ["L", "h_1", "h_2", "h_3"]}},
 "Info": {"SampleTime": 1, "ns": [15, 15], "ntot": 30},
 "Inputs": {"curv": {"dim": 1,
                     "ns": [0, 15],
                     "ntot": 15,
                     "sw": [0, 15],
                     "tw": [0, 0]},
            "steer": {"dim": 1,
                      "ns": [15, 0],
                      "ntot": 15,
                      "sw": [-15, 0],
                      "tw": [0, 0]},
            "steer_target": {"dim": 1,
                             "ns": [0, 1],
                             "ntot": 1,
                             "sw": [0, 1],
                             "tw": [0, 0]}},
 "Minimizers": {"steer_error": {"A": "SamplePart20",
                                "B": "steering_angle",
                                "loss": "mse"}},
 "Models": "steer_ctrl",
 "Outputs": {"steering_angle": "Add17"},
 "Parameters": {"fir_auto_regression": {"dim": 1,
                                        "sw": 15,
                                        "values": [[0.016767552122473717],
                                                   [0.005303405225276947],
                                                   [-0.0038569520693272352],
                                                   [-0.010703258216381073],
                                                   [-0.015175996348261833],
                                                   [-0.017066339030861855],
                                                   [-0.015829354524612427],
                                                   [-0.010536218993365765],
                                                   [-0.00021001417189836502],
                                                   [0.015462544746696949],
                                                   [0.03546605259180069],
                                                   [0.05740398168563843],
                                                   [0.07813771814107895],
                                                   [0.09457171708345413],
                                                   [0.10399305075407028]]},
                "fir_future_curv": {"dim": 1,
                                    "sw": 15,
                                    "values": [[0.2109629362821579],
                                               [0.1717863380908966],
                                               [0.132691890001297],
                                               [0.09327676892280579],
                                               [0.05614962428808212],
                                               [0.025458628311753273],
                                               [0.004048093222081661],
                                               [-0.008211039006710052],
                                               [-0.01375148817896843],
                                               [-0.015310073271393776],
                                               [-0.014386159367859364],
                                               [-0.011072470806539059],
                                               [-0.004858878441154957],
                                               [0.004422713536769152],
                                               [0.016104806214571]]},
                "h_1": {"dim": 1, "sw": 1, "values": [[0.0711696520447731]]},
                "h_2": {"dim": 1, "sw": 1, "values": [[2.4840190410614014]]},
                "h_3": {"dim": 1, "sw": 1, "values": [[-7.722520351409912]]}},
 "Relations": {"Add17": ["Add", ["ParamFun13", "Fir16"]],
               "Fir10": ["Fir", ["ParamFun9"], "fir_future_curv", null, 0],
               "Fir16": ["Fir",
                         ["SamplePart15"],
                         "fir_auto_regression",
                         null,
                         0],
               "ParamFun13": ["ParamFun", ["Fir10"], "FParamFun11"],
               "ParamFun9": ["ParamFun", ["SamplePart8"], "FParamFun7"],
               "SamplePart15": ["SamplePart", ["steer"], [-15, 0]],
               "SamplePart20": ["SamplePart", ["steer_target"], [0, 1]],
               "SamplePart8": ["SamplePart", ["curv"], [0, 15]]},
 "States": {}}